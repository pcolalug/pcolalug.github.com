<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
		<title>Print Page - OpenVPN between Linux and Solaris</title>
		<style type="text/css">
			body
			{
				color: black;
				background-color: white;
			}
			body, td, .normaltext
			{
				font-family: Verdana, arial, helvetica, serif;
				font-size: small;
			}
			*, a:link, a:visited, a:hover, a:active
			{
				color: black !important;
			}
			table
			{
				empty-cells: show;
			}
			.code
			{
				font-size: x-small;
				font-family: monospace;
				border: 1px solid black;
				margin: 1px;
				padding: 1px;
			}
			.quote
			{
				font-size: x-small;
				border: 1px solid black;
				margin: 1px;
				padding: 1px;
			}
			.smalltext, .quoteheader, .codeheader
			{
				font-size: x-small;
			}
			.largetext
			{
				font-size: large;
			}
			hr
			{
				height: 1px;
				border: 0;
				color: black;
				background-color: black;
			}
		</style>
	</head>
	<body>
		<h1 class="largetext">Pensacola Linux User's Group</h1>
		<h2 class="normaltext">Club Stuff => Articles => Topic started by: rugmonster on January 31, 2005, 09:47:59 am</h2>

		<table width="90%" cellpadding="0" cellspacing="0" border="0">
			<tr>
				<td>
					<br />
					<hr size="2" width="100%" />
					Title: <b>OpenVPN between Linux and Solaris</b><br />
					Post by: <b>rugmonster</b> on <b>January 31, 2005, 09:47:59 am</b>
					<hr />
					<div style="margin: 0 5ex;">This past weekend, I spent some time figuring out how to setup a VPN between my network and a friend who lives across town. The goal was to make it so that our two networks could communicate with each other without ports being blocked as well as securely across the Internet. Here is an example of the network layout...pardon the bad ascii<br /><div class="codeheader">Code:</div><div class="code"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Internal Net &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Internal Net<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|-------------| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|-------------|<br />10.20.50.0/24 &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; 192.168.2.0/24<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |-----| &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Internet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp;|-----|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |___|___/---/_____________/---/______|____| &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |eth0 &nbsp;/___/ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /___/ &nbsp; &nbsp; &nbsp; &nbsp;hme0| &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp;Linksys Router &nbsp; &nbsp;Linksys Router &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |=========================================| &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |_____| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Tunnel &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |_____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Gentoo Box &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Solaris Box</div><br /><br />On my network at home, I have my Gentoo Linux box running the 2.6.10 kernel. At my friends house, I have the Netra t1125 (http://www.pcolalug.org/phpBB2/viewtopic.php?t=2113&amp;highlight=) running Solaris 09/04. Both support IPSec natively, so that was what I looked into first. The problem was that both machines were being NAT'd by routers. The Authentication Header portion of IPSec requires the IP addresses of the source of origin and destination to match what is in the header of the IP packet. With this, NAT breaks the AH portion of IPSec. You can run IPSec without AH, which just encrypts the packet body, but at this point, you have to ask yourself why would I go through the headache of setting up IPSec if I'm not getting the full benefit?<br /><br />Enter OpenVPN (http://www.openvpn.net). I found OpenVPN in my search for an alternative VPN solution that would support NAT and work on Linux, as well as Solaris 9. OpenVPN is a utility that creates an IP tunnel between two machines, optionally encrypting the tunnel contents via SSL/TLS. OpenVPN can also be used for 802.1d Ethernet Bridging, but that is beyond the scope of this article.<br /><br />The Linux part was easy because there are several VPN solutions of varying degrees. Solaris was another story. While the other solutions may compile, I wanted to find something that said it supported Solaris out of the box. So I emerged OpenVPN on my linux box and started collecting the prerequisites for the Solaris machine.<br /><br />OpenVPN requires three things to work:<br /><br />1. [url-http://vtun.sourceforge.net/tun/]TUN/TAP[/url] driver to allow user-space programs to control a virtual point-to-point IP or Ethernet device.<br />2. OpenSSL (http://www.openssl.org/)<br />3. LZO real-time compression library (http://www.oberhumer.com/opensource/lzo/), required for link compression<br /><br />With Gentoo, all of these requirements were installed for me as dependencies. With the Solaris box, I had to download and compile the TUN/TAP driver and the LZO compression library. OpenSSL was installed via package from sunfreeware.com (http://www.sunfreeware.com).<br /><br />The only thing I had to do on the Gentoo box to meet this requirement was add TUN/TAP support, which is supported with the 2.6 kernels, found under:<br /><br />&nbsp; &nbsp; Device Drivers -&gt; Network Device Support -&gt;<br />Universal TUN/TAP device driver support<br /><br />After a quick recompile, TUN/TAP was ready to go. Next was the Solaris box.<br /><br />First, I downloaded the source for the LZO library. After a quick compile and install, I moved on to the TUN/TAP driver.<br /><br />One problem I ran into with the TUN/TAP driver was that the latest version was written for Solaris 8. Since I'm running Solaris 9, I had to do some fun things to get it to work with my version.<br /><br />With a standard ./configure &amp;&amp; make &amp;&amp; make install, I first got an error about the driver being compiled as 32-bit, but my kernel was 64-bit and would not load. On Solaris 9 systems that are 64-bit, you add CFLAGS=&quot;-m64&quot; as an environment variable. Unfortunately, the system wasn't using the CFLAG. Thankfully, only one file is compiled, so I took the gcc command that was displayed on the screen during the make and added in -m64.<br /><br />When you run make install, the files <b>tun</b> and <b>tun.conf</b> are installed to /usr/kernel/drv/. Solaris 9 requires <b>tun</b> to be copied to /usr/kernel/drv/solarisv9/, as such:<br /><div class="codeheader">Code:</div><div class="code">cp /usr/kernel/drv/tun /usr/kernel/drv/solarisv9/tun</div><br /><br />Following this, you have to tell the kernel the driver is there.<br /><div class="codeheader">Code:</div><div class="code">add_drv tun</div><br /><br />This should automagically create the tun device as /dev/tun.<br /><br />Back on your Linux box, you may need to create a tun device. If you don't find one, do the following:<br /><div class="codeheader">Code:</div><div class="code"># mknod /dev/net/tun c 10 200</div><br />I didn't have the /dev/net/ directory since I'm using udev. I did have a /dev/netlink/. OpenVPN looks for /dev/net/tun, so I did the following:<br /><div class="codeheader">Code:</div><div class="code"># mkdir /dev/net<br /># mknod /dev/netlink/tun c 10 200<br /># ln -s /dev/netlink/tun /dev/net/tun</div><br /><br />Now, you should have LZO, OpenSSL and tun devices. At this point, I had already installed OpenVPN on my Gentoo box, but had to compile it on the Solaris machine. Here is the configure with options that I used:<br /><div class="codeheader">Code:</div><div class="code">$ ./configure --with-lzo-libs=/usr/local/lib/ \<br />&gt; --with-lzo-headers=/usr/local/include/ \<br />&gt; --with-ssl-libs=/usr/local/ssl/lib/ \<br />&gt; --with-ssl-headers=/usr/local/ssl/include/</div><br />Once this is done, you should be able to do a make and make install and there should be a binary at /usr/local/sbin/openvpn. Easy enough...<br /><br />Next, I had to forward UDP port 5000 to the systems running OpenVPN. UDP port 5000 is used by default by OpenVPN, but you can specify another if you wish.<br /><br />To test your link, the best way is to start up an unencrypted OpenVPN session on each system. The way OpenVPN works is that both sides have to be setup. On machine #1 try this:<br /><div class="codeheader">Code:</div><div class="code"># openvpn --remote &lt;ip or dns name of Machine #2&gt; --dev tun --ifconfig 10.1.1.1 10.1.1.2 --verb 9</div><br />On machine #2:<br /><div class="codeheader">Code:</div><div class="code"># openvpn --remote &lt;ip or dns name of Machine #1&gt; --dev tun --ifconfig 10.1.1.2 10.1.1.1 --verb 9</div><br />What do all those flags mean? --remote is the ip or dns name of the system you want to establish the tunnel with. --dev specifies either the specific device under /dev/net/ you want to use (ex. --dev tun0 uses /dev/net/tun0) or if you just use tun, it will use whatever tun device is available if tun0 is already in use. This is useful if you run multiple tunnels. --ifconfig tells openvpn to setup the tunnel with the ip addresses in the form of --ifconfig &lt;local ip&gt; &lt;remote ip&gt;. --verb 9 sets the verbosity to the highest available, so you will see everything OpenVPN may have to say to include when packets are transferred back and forth through the tunnel.<br /><br />Once the tunnel comes up, from machine #1, you should be able to ping machine #2 at 10.1.1.2. If you can't, then there is a problem. Refer to the OpenVPN website for troubleshooting steps.<br /><br />Here is what my network looks like with the tunnel up:<br /><div class="codeheader">Code:</div><div class="code"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Internal Net &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Internal Net<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|-------------| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|-------------|<br />10.20.50.0/24 &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; 192.168.2.0/24<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |-----| &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Internet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp;|-----|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |___|___/---/_____________/---/______|____| &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |eth0 &nbsp;/___/ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /___/ &nbsp; &nbsp; &nbsp; &nbsp;hme0| &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp;Linksys Router &nbsp; &nbsp;Linksys Router &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; |=========================================| &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |_____|tun0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Tunnel &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tun0|_____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Gentoo Box &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10.20.1.0/24 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Solaris Box<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eth0 10.20.50.52 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hme0 192.168.2.101<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tun0 10.20.1.2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tun0 10.20.1.1</div><br /><br />Next, I had to add routes on both systems so they knew how to get traffic destined for the distant end internal subnet and tell them to forward IP traffic across interfaces. This means, my Gentoo box had to know how to get beyond the Solaris machine into the 192.168.2.0/24 network and the Solaris box will allow that traffic to travel from tun0 and out through hme0. To accomplish that, I ran these commands on the Gentoo box:<br /><div class="codeheader">Code:</div><div class="code"># route add -net 192.168.2.0 255.255.255.0 10.20.1.1<br /># echo 1 &gt; /proc/sys/net/ipv4/ip_forward</div><br />On the Solaris system:<br /><div class="codeheader">Code:</div><div class="code"># route add -net 10.20.1.0/24 10.20.1.2<br /># /usr/sbin/ndd -set /dev/ip ip_forwarding 1</div><br />Now, routes are in place on both tunnel gateways and they are both setup to forward traffic across interfaces.<br /><br />In my home network, I run a Linksys WRT54G wireless router with Sveasoft firmware. I was able to put a static route in my WRT54G to make traffic for the 10.20.1.0/24 and 192.168.2.0/24 networks forward to the Gentoo system. On the other network, my friend has a different router that does not give him the option to add static routes like this, so he changed the default gateway on all of his internal systems to point to the Solaris machine. This works because the Solaris machine still has a default gateway of his router, but also has the routes for the tunnel subnet as well as my home subnet. All traffic is routed appropriately so that when he wants a system to go to the Internet, it goes directly out his router and if it is destined for my network, it passes through the tunnel.<br /><br />So now, with routes in place, you should be able to ping all the way across, through the tunnel and into the distant end network. With --verb 9, you should even see a whole bunch of stuff flying scrolling across the screen that OpenVPN is running on as traffic passes by. <br /><br />There are a couple of problems...your tunnel isn't encrypted and as soon as you close the terminal that OpenVPN is running on, your tunnel will go down. <br /><br />First, let's secure that tunnel a bit with some encryption. You have the option of using static keys or using full SSL/TLS keys. I went with static keys because they are simpler. First, you create a key with the command:<br /><div class="codeheader">Code:</div><div class="code"># openvpn --genkey --secret static.key</div><br />A static key will be created in your current directory and stored in the file static.key. You should copy that file over to the other tunnel gateway using scp or some other secure transmission. To utilize static keys, you must use the same key file on both systems.<br /><br />Once this is done, you can test it out much like you did the unencrypted tunnel before:<br /><div class="codeheader">Code:</div><div class="code"># openvpn --remote &lt;ip or dns name of Machine #2&gt; --dev tun --ifconfig &lt;local tun ip&gt; &lt;remote tun ip&gt; --static &lt;location of static.key&gt; --verb 9</div><br />Note that when you take the tun interface down and bring it back up (stopping and starting OpenVPN), you may need to re-enter the static route for the distant end network.<br /><br />Everything working alright now? Well, it is for me. I don't want to have to start up this tunnel everytime the system is rebooted or should the Internet connection drop for one of the systems. Here are my ideas for making this a more robust connection.<br /><br />All of those --<i>flag</i> options can be put into a configuration file. Here is what I plan to use for both of gateways:<br /><br />Solaris (http://members.cox.net/dgivens4/solaris.txt)<br />Gentoo (http://members.cox.net/dgivens4/gentoo.txt)<br /><br />Solaris will be setup to run OpenVPN in daemon mode. It will start up on boot and ping the other end of the tunnel every 15 seconds. If there is no reply after 30 seconds, it will try to reestablish the connection. On the Gentoo side, I will run it from xinetd, listening for requests on UDP port 5000. It too will try to ping the other side every 15 seconds, but exit after 30 seconds with no reply. I have yet to implement this, but there are instructions on how to setup OpenVPN as daemon and run from inetd/xinetd on the OpenVPN web site.<br /><br />Well, there you have it. I hope this provides some assistance to you. I would also like to point out that there is a Win32 and Mac OS X version of OpenVPN available for those who travel with their laptop that isn't running Linux and still want to have secure access to their internal network. <br /><br />Please let me know if you have any questions. I will do my best to answer them. Happy tunnelling!</div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>OpenVPN between Linux and Solaris</b><br />
					Post by: <b>hitechwizard</b> on <b>February 03, 2005, 10:23:03 pm</b>
					<hr />
					<div style="margin: 0 5ex;">Amazingly how appropriate the timing is. My problem is that I need openvpn to work between an openbsd box and windows clients. I've managed to get it mostly setup, but have serious problems getting the actual bridge to work. Sniffing the wire I can see traffic going back and forth on port 1194 (default for the RC6 version) and the two boxes seem to connect, but nothing happens after that. Here's the configs for:<br /><br />OpenBSD Box:<br /><div class="codeheader">Code:</div><div class="code"><br />remote somewhere.onthe.net<br />&nbsp; &nbsp; &nbsp; &nbsp; port 1194<br />&nbsp; &nbsp; &nbsp; &nbsp; float<br />&nbsp; &nbsp; &nbsp; &nbsp; dev tun0<br />&nbsp; &nbsp; &nbsp; &nbsp; ifconfig 192.168.1.200 192.168.1.201<br />&nbsp; &nbsp; &nbsp; &nbsp; ping 15<br />&nbsp; &nbsp; &nbsp; &nbsp; secret openvpn.key<br />&nbsp; &nbsp; &nbsp; &nbsp; verb 9<br />&nbsp; &nbsp; &nbsp; &nbsp; tun-mtu 1500<br />&nbsp; &nbsp; &nbsp; &nbsp; tun-mtu-extra 32<br />&nbsp; &nbsp; &nbsp; &nbsp; mssfix 1450<br />&nbsp; &nbsp; &nbsp; &nbsp; ifconfig-nowarn<br /></div><br /><br />Windows Box:<br /><div class="codeheader">Code:</div><div class="code"><br />remote somewhere.onthe.net<br />&nbsp; &nbsp; dev tap<br />&nbsp; &nbsp; dev-node TAP-Home<br />&nbsp; &nbsp; ping 15<br />&nbsp; &nbsp; ifconfig 192.168.1.201 255.255.255.0<br />&nbsp; &nbsp; secret home.key<br />&nbsp; &nbsp; tun-mtu 1500<br />&nbsp; &nbsp; tun-mtu-extra 32<br />&nbsp; &nbsp; mssfix 1450<br /></div><br /><br />Any hints to getting this work would be great. I thought it might be routing related, but then I realized that I can't even ping across the VPN, so I don't think routing is my issue. On the windows box, the TAP adapter gets the 192.168.1.201 address, and it can ping it, but can not ping 192.168.1.200. On the openBSD box, ifconfig shows:<br /><div class="codeheader">Code:</div><div class="code"><br />tun0&#58; flags=51&lt;UP,POINTOPOINT,RUNNING&gt; mtu 1500<br />&nbsp; &nbsp; &nbsp; &nbsp; inet 192.168.1.200 --&gt; 192.168.1.201 netmask 0xffffffff<br /></div><br />But you can't ping either address from anywhere, including the OpenBSD box.<br /><br />Any Ideas?</div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>OpenVPN between Linux and Solaris</b><br />
					Post by: <b>rugmonster</b> on <b>February 04, 2005, 08:17:16 am</b>
					<hr />
					<div style="margin: 0 5ex;">From my understanding, tap is used for 802.1d bridging and tun is used for tunneling. AFAIK, only Linux and FreeBSD support ethernet bridging unless you can get OpenBSD's bridge (http://www.openbsd.org/cgi-bin/man.cgi?query=bridge&amp;sektion=4) to work. Reading on the openvpn page, Win32 only has support for tap. <br /><br />As a caveat, you can only have one connection per port, so if you have multiple tunnels/bridges, you have to have each running on their own port.</div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>OpenVPN between Linux and Solaris</b><br />
					Post by: <b>steve</b> on <b>February 04, 2005, 09:57:45 am</b>
					<hr />
					<div style="margin: 0 5ex;"><div class="quoteheader">Quote from: hitechwizard</div><div class="quote">Here's the configs for:<br /><br />OpenBSD Box:<br /><div class="codeheader">Code:</div><div class="code"><br />remote somewhere.onthe.net<br />&nbsp; &nbsp; &nbsp; &nbsp; port 1194<br />&nbsp; &nbsp; &nbsp; &nbsp; float<br />&nbsp; &nbsp; &nbsp; &nbsp; dev tun0<br />&nbsp; &nbsp; &nbsp; &nbsp; ifconfig 192.168.1.200 192.168.1.201<br />&nbsp; &nbsp; &nbsp; &nbsp; ping 15<br />&nbsp; &nbsp; &nbsp; &nbsp; secret openvpn.key<br />&nbsp; &nbsp; &nbsp; &nbsp; verb 9<br />&nbsp; &nbsp; &nbsp; &nbsp; tun-mtu 1500<br />&nbsp; &nbsp; &nbsp; &nbsp; tun-mtu-extra 32<br />&nbsp; &nbsp; &nbsp; &nbsp; mssfix 1450<br />&nbsp; &nbsp; &nbsp; &nbsp; ifconfig-nowarn<br /></div><br /><br />Windows Box:<br /><div class="codeheader">Code:</div><div class="code"><br />remote somewhere.onthe.net<br />&nbsp; &nbsp; dev tap<br />&nbsp; &nbsp; dev-node TAP-Home<br />&nbsp; &nbsp; ping 15<br />&nbsp; &nbsp; ifconfig 192.168.1.201 255.255.255.0<br />&nbsp; &nbsp; secret home.key<br />&nbsp; &nbsp; tun-mtu 1500<br />&nbsp; &nbsp; tun-mtu-extra 32<br />&nbsp; &nbsp; mssfix 1450<br /></div><br /><br />Any hints to getting this work would be great. I thought it might be routing related, but then I realized that I can't even ping across the VPN, so I don't think routing is my issue. On the windows box, the TAP adapter gets the 192.168.1.201 address, and it can ping it, but can not ping 192.168.1.200. On the openBSD box, ifconfig shows:<br /><div class="codeheader">Code:</div><div class="code"><br />tun0&#58; flags=51&lt;UP,POINTOPOINT,RUNNING&gt; mtu 1500<br />&nbsp; &nbsp; &nbsp; &nbsp; inet 192.168.1.200 --&gt; 192.168.1.201 netmask 0xffffffff<br /></div><br />But you can't ping either address from anywhere, including the OpenBSD box.<br /><br />Any Ideas?</div><br /><br />Not sur eif this will help, but...<br /><br />I haven't set anything up using openvpn but I have setup quite a few Windows VPNs and router to router VPNs. I noticed that both, the local and remote computers, are using the same local subnet schema. In my experience, this can't be done. I've found that the two networks had to be using differnt local subnets. ie. 192.168.1.x/24 on one side and 192.168.2.x/24 on the other side.<br /><br />Steve</div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>OpenVPN between Linux and Solaris</b><br />
					Post by: <b>rugmonster</b> on <b>February 04, 2005, 04:18:47 pm</b>
					<hr />
					<div style="margin: 0 5ex;">The way OpenVPN configures is you tell it the local and remote tunnel IP. While you are correct in that the subnets on either side of the tunnel have to be seperate subnets, so in a tunnel configuration you would have three seperate subnets, I don't think this is the issue. I believe the problem lies in what I said before, being the difference in tunnel and bridge.</div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>OpenVPN between Linux and Solaris</b><br />
					Post by: <b>hitechwizard</b> on <b>February 04, 2005, 07:51:29 pm</b>
					<hr />
					<div style="margin: 0 5ex;">Ended up going with a much simpler client from Vast Range called &nbsp;Safe Passage (http://vast-range.com). No setup required on the server other than having a valid user account to SSH into, and the client is about as simple. The great thing about the Safe Passage client is you can identify which networks/clients go through the tunnel, and which ones go as normal. Not a bad product for a $29.95 registration per client.</div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>OpenVPN between Linux and Solaris</b><br />
					Post by: <b>lloydr</b> on <b>February 05, 2005, 10:36:46 am</b>
					<hr />
					<div style="margin: 0 5ex;"><div class="quoteheader">Quote from: hitechwizard</div><div class="quote">Ended up going with a much simpler client from Vast Range called &nbsp;Safe Passage (http://vast-range.com). No setup required on the server other than having a valid user account to SSH into, and the client is about as simple. The great thing about the Safe Passage client is you can identify which networks/clients go through the tunnel, and which ones go as normal. Not a bad product for a $29.95 registration per client.</div><br /><br />can't you basically get the same thing out of openbsd's bridging function mixed in with authpf?<br />http://www.openbsd.org/faq/pf/authpf.html</div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>OpenVPN between Linux and Solaris</b><br />
					Post by: <b>hitechwizard</b> on <b>February 05, 2005, 10:57:42 am</b>
					<hr />
					<div style="margin: 0 5ex;">Not really. While that would poke the holes in the firewall to allow the packets to flow, I needed the packets to actually run inside the ssh tunnel created, which is what the Safe Passage client does. If I didn't need the encryption on the data, authpf would have been the answer.</div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>Solaris setting please? - Re: OpenVPN between Linux and Solaris</b><br />
					Post by: <b>jhuang</b> on <b>August 08, 2006, 05:21:06 pm</b>
					<hr />
					<div style="margin: 0 5ex;">Hi Rugmonster,<br /><br />Regarding your article &quot;OpenVPN between Linux and Solaris&quot;, can you tell me what Solaris settings (compiler, make versions etc.) that you use?&nbsp; e.g. what&#039;s your output of the following commands?<br />===============<br /># uname -a<br /># which gcc<br /># gcc -v<br /># which make<br /># make -v<br />===============<br /><br />I&#039;m starting to install OpenVPN on Solaris. I have some old versions like the following that have problem when installing tun driver, and would like to upgrade based on your suggestions. Thanks a lot.<br />---------------------<br /># uname -a<br />SunOS sideswipe 5.9 Generic_117171-09 sun4u sparc SUNW,Serverblade1<br /># which gcc<br />/usr/local/bin/gcc<br /># gcc -v<br />Reading specs from /usr/local/lib/gcc-lib/sparc-sun-solaris2.6/2.95.3/specs<br />gcc version 2.95.3 20010315 (release)<br /># which make<br />/usr/local/bin/make<br /># make -v<br />GNU Make version 3.76.1, by Richard Stallman and Roland McGrath.<br />Copyright (C) 1988, 89, 90, 91, 92, 93, 94, 95, 96, 97<br />&nbsp; &nbsp; &nbsp; &nbsp; Free Software Foundation, Inc.<br />This is free software; see the source for copying conditions.<br />There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.<br /><br />Report bugs to &lt;bug-gnu-utils@prep.ai.mit.edu&gt;.<br /></div>
					<br />
					<hr size="2" width="100%" />
					Title: <b>Re: OpenVPN between Linux and Solaris</b><br />
					Post by: <b>rugmonster</b> on <b>August 08, 2006, 06:46:07 pm</b>
					<hr />
					<div style="margin: 0 5ex;">I&#039;m not running that system anymore, but at the time the Netra was running Solaris 9 (same as you) and I was using current versions of gcc and make that were part of the Sun Freeware packages.<br /><br />As a suggestion, have you searched the OpenVPN-users mailing list?<br /><br />Here is a post I just found.<br /><br />http://openvpn.net/archive/openvpn-users/2005-06/msg00241.html<br /><br />WIthout more to go on, we can&#039;t really help you track down a possible solution. What specific errors are you getting?</div>
					<br /><br />
					<div align="center" class="smalltext">
		<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://www.simplemachines.org/" title="Simple Machines Forum" target="_blank">Powered by SMF 1.1.13</a> |
<a href="http://www.simplemachines.org/about/copyright.php" title="Free Forum Software" target="_blank">SMF &copy; 2006-2011, Simple Machines LLC</a>
		</span></div>
				</td>
			</tr>
		</table>
	</body>
</html>