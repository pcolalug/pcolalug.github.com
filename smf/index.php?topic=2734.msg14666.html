<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<meta name="description" content="linblock - like peerguardian...but better" />
	<meta name="robots" content="noindex" />
	<meta name="keywords" content="PHP, MySQL, bulletin, board, free, open, source, smf, simple, machines, forum" />
	<script language="JavaScript" type="text/javascript" src="Themes/default/script.js%3Ffin11"></script>
	<script language="JavaScript" type="text/javascript"><!-- // --><![CDATA[
		var smf_theme_url = "http://www.pcolalug.org/smf/Themes/babylon";
		var smf_images_url = "http://www.pcolalug.org/smf/Themes/babylon/images";
		var smf_scripturl = "http://www.pcolalug.org/smf/index.php";
		var smf_iso_case_folding = false;
		var smf_charset = "ISO-8859-1";
	// ]]></script>
	<title>linblock - like peerguardian...but better</title>
	<link rel="stylesheet" type="text/css" href="Themes/babylon/style.css%3Ffin11.css" />
	<link rel="stylesheet" type="text/css" href="Themes/default/print.css%3Ffin11.css" media="print" />
	<link rel="help" href="index.php%3Faction=help.html" target="_blank" />
	<link rel="search" href="index.php%3Faction=search.html" />
	<link rel="contents" href="index.php.html" />
	<link rel="alternate" type="application/rss+xml" title="Pensacola Linux User's Group - RSS" href="index.php%3Ftype=rss%3Baction=.xml" />
	<link rel="prev" href="index.php%3Ftopic=2734.0%3Bprev_next=prev.html" />
	<link rel="next" href="index.php%3Ftopic=2734.0%3Bprev_next=next.html" />
	<link rel="index" href="index.php%3Fboard=48.0.html" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />

	<script language="JavaScript" type="text/javascript"><!-- // --><![CDATA[
		var current_header = false;

		function shrinkHeader(mode)
		{
			document.cookie = "upshrink=" + (mode ? 1 : 0);
			document.getElementById("upshrink").src = smf_images_url + (mode ? "/upshrink2.gif" : "/upshrink.gif");

			document.getElementById("upshrinkHeader").style.display = mode ? "none" : "";

			current_header = mode;
		}
	// ]]></script>
</head>
<body>
	<div id="headerarea" style="padding: 12px 30px 4px 30px;">
		<table cellspacing="0" cellpadding="0" border="0" width="100%" style="position: relative;">
			<tr>
				<td colspan="2" valign="bottom" style="padding: 5px; white-space: nowrap;">
					<img src="Themes/babylon/images/smflogo.gif" style="width: 250px; float: right;" alt="" />
					<span style="font-family: Georgia, sans-serif; font-size: xx-large;">Pensacola Linux User's Group</span>
				</td>
			</tr>
			<tr id="upshrinkHeader">
				<td valign="top">
					<div class="headertitles" style="margin-right: 5px; position: relative;"><img src="Themes/babylon/images/blank.gif" height="12" alt="" /></div>
					<div class="headerbodies" style="position: relative; margin-right: 5px; background-image: url(Themes/babylon/images/box_bg.gif);">
						<img src="Themes/babylon/images/english/userinfo.gif" style="position: absolute; left: -1px; top: -16px; clear: both;" alt="" />
						<table width="99%" cellpadding="0" cellspacing="5" border="0"><tr><td valign="top" class="smalltext" style="width: 100%; font-family: verdana, arial, sans-serif;">
							Welcome, <b>Guest</b>. Please <a href="index.php%3Faction=login.html">login</a> or <a href="index.php%3Faction=register.html">register</a>.<br />
							November 19, 2011, 02:25:30 pm<br />

							<script language="JavaScript" type="text/javascript" src="Themes/default/sha1.js"></script>

							<form action="http://www.pcolalug.org/smf/index.php?action=login2" method="post" accept-charset="ISO-8859-1" style="margin: 3px 1ex 1px 0;" onsubmit="hashLoginPassword(this, '706836f2c9352cfd8e021c614df871f7');">
								<div style="text-align: right;">
									<input type="text" name="user" size="10" /> <input type="password" name="passwrd" size="10" />
									<select name="cookielength">
										<option value="60">1 Hour</option>
										<option value="1440">1 Day</option>
										<option value="10080">1 Week</option>
										<option value="43200">1 Month</option>
										<option value="-1" selected="selected">Forever</option>
									</select>
									<input type="submit" value="Login" /><br />
									Login with username, password and session length
									<input type="hidden" name="hash_passwrd" value="" />
								</div>
							</form>
						</td></tr></table>
					</div>

					<form action="http://www.pcolalug.org/smf/index.php?action=search2" method="post" accept-charset="ISO-8859-1" style="margin: 0;">
						<div style="margin-top: 7px;">
							<b>Search: </b><input type="text" name="search" value="" style="width: 190px;" />&nbsp;
							<input type="submit" name="submit" value="Search" style="width: 8ex;" />&nbsp;
							<a href="index.php%3Faction=search%3Badvanced.html">Advanced search</a>
							<input type="hidden" name="advanced" value="0" />
							<input type="hidden" name="topic" value="2734" />
						</div>
					</form>

				</td>
				<td style="width: 262px; padding-left: 6px;" valign="top">
					<div class="headertitles" style="width: 260px;"><img src="Themes/babylon/images/blank.gif" height="12" alt="" /></div>
					<div class="headerbodies" style="width: 260px; position: relative; background-image: url(Themes/babylon/images/box_bg.gif); margin-bottom: 8px;">
						<img src="Themes/babylon/images/english/newsbox.gif" style="position: absolute; left: -1px; top: -16px;" alt="" />
						<div style="height: 50px; overflow: auto; padding: 5px;" class="smalltext">Happy New Year!</div>
					</div>
					<div class="headertitles" style="width: 260px;"><img src="Themes/babylon/images/blank.gif" height="12" alt="" /></div>
					<div class="headerbodies" style="width: 260px; position: relative; background-image: url(Themes/babylon/images/box_bg.gif);">
						<img src="Themes/babylon/images/english/keystats.gif" style="position: absolute; left: -1px; top: -16px;" alt="" />
						<div style="min-height: 35px; padding: 5px;" class="smalltext">
							<b>15812</b> Posts in <b>3083</b> Topics by <span style="white-space: nowrap;"><b>139</b> Members</span><br />
							Latest Member: <b> <a href="index.php%3Faction=profile%3Bu=2198.html">speakatself</a></b>
						</div>
					</div>
				</td>
			</tr>
		</table>

		<a href="javascript:void(0);" onclick="shrinkHeader(!current_header); return false;"><img id="upshrink" src="Themes/babylon/images/upshrink.gif" alt="*" title="Shrink or expand the header." style="margin: 2px 2ex 2px 0;" border="0" /></a>
				<a href="index.php.html"><img src="Themes/babylon/images/english/home.gif" alt="Home" style="margin: 2px 0;" border="0" /></a> 
				<a href="index.php%3Faction=help.html"><img src="Themes/babylon/images/english/help.gif" alt="Help" style="margin: 2px 0;" border="0" /></a> 
				<a href="index.php%3Faction=search.html"><img src="Themes/babylon/images/english/search.gif" alt="Search" style="margin: 2px 0;" border="0" /></a> 
				<a href="index.php%3Faction=calendar.html"><img src="Themes/babylon/images/english/calendar.gif" alt="Calendar" style="margin: 2px 0;" border="0" /></a> 
				<a href="index.php%3Faction=login.html"><img src="Themes/babylon/images/english/login.gif" alt="Login" style="margin: 2px 0;" border="0" /></a> 
				<a href="index.php%3Faction=register.html"><img src="Themes/babylon/images/english/register.gif" alt="Register" style="margin: 2px 0;" border="0" /></a>
	</div>
	<table width="100%" cellpadding="0" cellspacing="0" border="0"><tr>
		<td id="bodyarea" style="padding: 1ex 20px 2ex 20px;">
<a name="top"></a>
<a name="msg13648"></a>
<table width="100%" cellpadding="3" cellspacing="0">
	<tr>
		<td valign="bottom"><span class="nav"><img src="Themes/babylon/images/icons/folder_open.gif" alt="+" border="0" />&nbsp; <b><a href="index.php.html" class="nav">Pensacola Linux User's Group</a></b><br /><img src="Themes/babylon/images/icons/linktree_side.gif" alt="|-" border="0" /><img src="Themes/babylon/images/icons/folder_open.gif" alt="+" border="0" />&nbsp; <b><a href="index.php.html#5" class="nav">Software</a></b><br /><img src="Themes/babylon/images/icons/linktree_main.gif" alt="| " border="0" /><img src="Themes/babylon/images/icons/linktree_side.gif" alt="|-" border="0" /><img src="Themes/babylon/images/icons/folder_open.gif" alt="+" border="0" />&nbsp; <b><a href="index.php%3Fboard=48.0.html" class="nav">Networking</a></b><br /><img src="Themes/babylon/images/icons/linktree_main.gif" alt="| " border="0" /><img src="Themes/babylon/images/icons/linktree_main.gif" alt="| " border="0" /><img src="Themes/babylon/images/icons/linktree_side.gif" alt="|-" border="0" /><img src="Themes/babylon/images/icons/folder_open.gif" alt="+" border="0" />&nbsp; <b><a href="index.php%3Ftopic=2734.0.html" class="nav">linblock - like peerguardian...but better</a></b></span></td>
		<td valign="bottom" align="right" class="smalltext">
			<span class="nav"><a href="index.php%3Ftopic=2734.0%3Bprev_next=prev.html#new">&laquo; previous</a> <a href="index.php%3Ftopic=2734.0%3Bprev_next=next.html#new">next &raquo;</a></span>
		</td>
	</tr>
</table>
<table width="100%" cellpadding="3" cellspacing="0" border="0" class="tborder" style="margin-bottom: 1ex;">
	<tr>
		<td class="catbg" width="100%" height="35">
			<table cellpadding="3" cellspacing="0" width="100%">
				<tr>
					<td>
						<b>Pages:</b> [<b>1</b>] 
					</td>
					<td align="right" style="font-size: smaller;"><a href="index.php%3Faction=printpage%3Btopic=2734.0.html" target="_blank"><img src="Themes/babylon/images/english/print.gif" alt="Print" border="0" /></a></td>
				</tr>
			</table>
		</td>
	</tr>
</table>
<table width="100%" cellpadding="3" cellspacing="0" border="0" class="tborder" style="border-bottom: 0;">
	<tr class="titlebg">
		<td valign="middle" width="15%" style="padding-left: 6px;">
			<img src="Themes/babylon/images/topic/normal_post.gif" alt="" align="middle" /> Author
		</td>
		<td valign="middle" width="85%" style="padding-left: 6px;" id="top_subject">
			Topic: linblock - like peerguardian...but better &nbsp;(Read 6984 times)
		</td>
	</tr>
</table>
<form action="http://www.pcolalug.org/smf/index.php?action=quickmod2;topic=2734.0" method="post" name="quickModForm" accept-charset="ISO-8859-1" id="quickModForm" style="margin: 0;" onsubmit="return in_edit_mode == 1 ? modify_save('706836f2c9352cfd8e021c614df871f7') : confirm('Are you sure you want to do this?');">
<table cellpadding="0" cellspacing="0" border="0" width="100%" class="bordercolor">
	<tr><td style="padding: 1px 1px 0 1px;">
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=44.html" title="View the profile of rugmonster">rugmonster</a></b>
							<div class="smalltext">
								Old Hand<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 1534<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=11%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=44.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
								<a href="http://rugmonster.org" title="" target="_blank"><img src="Themes/babylon/images/www_sm.gif" alt="WWW" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg13648.html#msg13648"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_13648">
										<a href="index.php%3Ftopic=2734.msg13648.html#msg13648">linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b> on:</b> December 16, 2005, 08:04:36 am &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">I just found <a href="http://www.dessent.net/linblock/" target="_blank">linblock</a>. Linblock works like peerguardian in that it downloads a list of IP addresses that are known to be not-so-friendly to p2p networks and blocks them. The way linblock is different from peerguardian is that linblock actually blocks those addresses with iptables, making it much more efficient. It lends itself well to automatic updates via cronjob and you can also specify different list URLs for the chance you want to use another list. <br /><br />The idea that comes to mind is having something that checks your system logs for obvious ssh bot attacks and port scans and adds their IP to a file formatted in the peerguardian style.</div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_13648">
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">--<br />Daniel</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg13749"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg2">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=44.html" title="View the profile of rugmonster">rugmonster</a></b>
							<div class="smalltext">
								Old Hand<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 1534<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=11%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=44.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
								<a href="http://rugmonster.org" title="" target="_blank"><img src="Themes/babylon/images/www_sm.gif" alt="WWW" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg13749.html#msg13749"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_13749">
										<a href="index.php%3Ftopic=2734.msg13749.html#msg13749">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #1 on:</b> January 10, 2006, 09:36:46 pm &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">Weeeeellll...the idea is good, but when used for it&#039;s intended use, it sucks. You wind up with about 100,000 entries in an iptables input chain. That&#039;s bad in practice because every single network packet that comes into your system has to be evaluated against every single one of those entries to get to the default permit statement.<br /><br />For instance, tonight, I was streaming a video from my desktop which had all of those ips blocked to the modded Xbox. I had lag over a 100mb/s connection. Lag in video. My wireless computer in the back bedroom gets 2mb/s at best and doesn&#039;t lag on videos. <br /><br />I&#039;m still going to use it&#039;s option to load an ip list from a local file to block ssh bots, though...</div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_13749">
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">--<br />Daniel</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg13762"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=44.html" title="View the profile of rugmonster">rugmonster</a></b>
							<div class="smalltext">
								Old Hand<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 1534<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=11%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=44.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
								<a href="http://rugmonster.org" title="" target="_blank"><img src="Themes/babylon/images/www_sm.gif" alt="WWW" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg13762.html#msg13762"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_13762">
										<a href="index.php%3Ftopic=2734.msg13762.html#msg13762">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #2 on:</b> January 13, 2006, 11:55:29 am &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">As mention above, here is a script to look at your auth.log and generate a peerguardian/linblock compliant block list.<br /><br /><div class="codeheader">Code:</div><div class="code">#!/usr/bin/perl<br />use Net::DNS;<br /><br />$authlog = &quot;/var/log/auth.log&quot;;<br />$sshers = &quot;sshers&quot;;<br />$pattern = &#039;.* localhost sshd\[[0-9]+\]: Invalid user .* from&#039;;<br />$failed_attempts = 3;<br /><br /><br />open(AUTH, $authlog) or die &quot;Cannot open auth.log: $!&quot;;<br />open(SSHERS_WRITE, &quot;+&gt;&gt;$sshers&quot;) or die &quot;Cannot open sshers for writing purposes: $!&quot;;<br />open(SSHERS_READ, &quot;&lt;$sshers&quot;) or die &quot;Cannot open sshers for reading purposes: $!&quot;;<br /><br />$i = 0;<br />while (&lt;SSHERS_READ&gt;) {<br /><span style="white-space: pre;">	</span>chomp;<br /><span style="white-space: pre;">	</span>$sshers[$i] = $_;<br /><span style="white-space: pre;">	</span>$i++;<br />}<br /><br />while (&lt;AUTH&gt;) {<br /><span style="white-space: pre;">	</span>$i++;<br /><span style="white-space: pre;">	</span>$known=0;<br /><span style="white-space: pre;">	</span>chomp;<br /><span style="white-space: pre;">	</span>if (/($pattern)/) {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>@fields = split / +/, $_;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$ipaddy = $fields[9];<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>foreach $key (@sshers) {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>if ($key =~ /$ipaddy/) {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$known = 1;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>}<span style="white-space: pre;">	</span><br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>}<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>if ($known != 1) {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>if ($newips{$ipaddy}) {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$newips{$ipaddy}++;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>} else {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$newips{$ipaddy} = 1;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>}<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>if ($newips{$ipaddy} == $failed_attempts) {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$res = Net::DNS::Resolver-&gt;new;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$query = $res-&gt;search($ipaddy);<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>if ($query) {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>foreach $rr ($query-&gt;answer) {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>next unless $rr-&gt;type eq &#039;PTR&#039;;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$dnsaddr = $rr-&gt;ptrdname;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>}<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>} else {<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$dnsaddr = &quot;no rDNS info available&quot;;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>}<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>printf SSHERS_WRITE &quot;Script Kiddie at %s:%s-%s\n&quot;, $dnsaddr, $ipaddy, $ipaddy;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$sshers[$i] = $ipaddy;<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>$i++<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>}<br /><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>}<br /><span style="white-space: pre;">	</span>}<br />}<br /><br />close(AUTH);<br />close(SSHERS);</div><br />$failed_attempts - you set the threshold on the number of failed attempts before you block the IP. <br />$authlog - can be set for any file you want to check. <br />$sshers - is where you want the output file to be written. <br />$pattern - what you&#039;re looking for.&nbsp; <b>*Default will match a pattern such as the following</b><br /><div class="codeheader">Code:</div><div class="code">Jan 11 07:17:47 localhost sshd[5197]: Invalid user skylyn from xxx.xxx.xxx.xxx</div><br />So, you can run the script (save as blockgen.pl and chmod +x it), run as root and then point linblock.pl at it.<br /><br />Example:<br /><div class="codeheader">Code:</div><div class="code"># ./blockgen.pl<br /># linblock.pl -i sshers -c sshers<br /></div><br />For linblock.pl options, execute with the --help flag. Enjoy!</div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_13762">
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">--<br />Daniel</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg13763"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg2">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=44.html" title="View the profile of rugmonster">rugmonster</a></b>
							<div class="smalltext">
								Old Hand<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 1534<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=11%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=44.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
								<a href="http://rugmonster.org" title="" target="_blank"><img src="Themes/babylon/images/www_sm.gif" alt="WWW" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg13763.html#msg13763"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_13763">
										<a href="index.php%3Ftopic=2734.msg13763.html#msg13763">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #3 on:</b> January 14, 2006, 11:55:06 am &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">I just changed the script a bit. I realized when I went to add a cronjob for it, that I should make my script call linblock directly as soon as it&#039;s done. I also added in tons of comments. <br /><br />If you guys have any suggestions for brevity, please let me know. I&#039;m very much a novice with Perl (i.e. know enough to break stuff).<br /><br /></div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_13763">
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">--<br />Daniel</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg13939"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=44.html" title="View the profile of rugmonster">rugmonster</a></b>
							<div class="smalltext">
								Old Hand<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 1534<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=11%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=44.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
								<a href="http://rugmonster.org" title="" target="_blank"><img src="Themes/babylon/images/www_sm.gif" alt="WWW" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg13939.html#msg13939"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_13939">
										<a href="index.php%3Ftopic=2734.msg13939.html#msg13939">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #4 on:</b> February 19, 2006, 01:36:35 pm &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">I just got done with a modification of linblock.pl and blockgen.pl.&nbsp; I added the ability to specify a protocol and port in linblock.pl.&nbsp; I made block files for APNIC, RIPE, AfriNIC and LACNIC and now use those to stop most of the dictionary attacks. <br /><br />APNIC&#039;s Major IP Blocks<br /><div class="codeheader">Code:</div><div class="code">APNIC:58.0.0.0-61.255.255.255<br />APNIC:121.0.0.0-126.255.255.255<br />APNIC:202.0.0.0-203.255.255.255<br />APNIC:210.0.0.0-211.255.255.255<br />APNIC:218.0.0.0-222.255.255.255<br /></div><br />RIPE&#039;s Major IP Blocks<br /><div class="codeheader">Code:</div><div class="code">RIPE:62.0.0.0-62.255.255.255<br />RIPE:80.0.0.0-91.255.255.255<br />RIPE:193.0.0.0-195.255.255.255<br />RIPE:212.0.0.0-213.255.255.255<br />RIPE:217.0.0.0-217.255.255.255<br /></div><br />LACNIC&#039;s Major IP Blocks<br /><div class="codeheader">Code:</div><div class="code">LACNIC:189.0.0.0-190.255.255.255<br />LACNIC:200.0.0.0-201.255.255.255<br /></div><br />AfriNIC&#039;s Major IP Block<br /><div class="codeheader">Code:</div><div class="code">AfriNIC:41.0.0.0-41.255.255.255<br /></div></div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_13939">
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">--<br />Daniel</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg13945"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg2">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=83.html" title="View the profile of Brent">Brent</a></b>
							<div class="smalltext">
								Master<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 464<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=37%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								kaboom?<br />
								<br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=83.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg13945.html#msg13945"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_13945">
										<a href="index.php%3Ftopic=2734.msg13945.html#msg13945">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #5 on:</b> February 20, 2006, 03:47:34 pm &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">So, is it yet possible and practical to use linblock as intended?&nbsp; Can you customize it to block ip adresses *just* on certian ports?&nbsp; It seems to me the problem as you&#039;ve described it, as it has to crosscheck every ip address connecting for any service against the entire list.&nbsp; Sounds like it would be much more practical to say &quot;If someone trys to connect on port (for example) 6881, and he is on a blacklist, deny access&quot;.&nbsp; I&#039;m still wondering if this would be an effective replacement for the safepeer azureus plugin.&nbsp; This would allow people on slower computers to use lighterwieght bt clients, and still restrict access to &#039;undesirables&#039;.</div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_13945">
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">&quot;Which is worse, ignorance or apathy ?&nbsp; Who knows?&nbsp; Who cares?&quot;</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg13948"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=44.html" title="View the profile of rugmonster">rugmonster</a></b>
							<div class="smalltext">
								Old Hand<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 1534<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=11%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=44.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
								<a href="http://rugmonster.org" title="" target="_blank"><img src="Themes/babylon/images/www_sm.gif" alt="WWW" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg13948.html#msg13948"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_13948">
										<a href="index.php%3Ftopic=2734.msg13948.html#msg13948">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #6 on:</b> February 21, 2006, 06:03:42 am &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">The site that distributes linblock says that the following should help with the over slowness that comes from loading such a large ACL into iptables. <br /><br /><div class="codeheader">Code:</div><div class="code">iptables -R INPUT 1 -m state --state NEW,RELATED -j antip2p</div><br />Rather than look at every single connection, only look at the new and related ones. This requires the ip_conntrack module to be loaded. Along with my modification (the addition of the -o [tcp|udp|both] and -d [destination-port] options), you should be able to get the desired results.<br /><br />I&#039;ll take a look at the script and add an option to use those states and post it back here.</div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_13948">
									&#171; <i>Last Edit: February 21, 2006, 06:35:44 am by rugmonster</i> &#187;
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">--<br />Daniel</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg14661"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg2">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=44.html" title="View the profile of rugmonster">rugmonster</a></b>
							<div class="smalltext">
								Old Hand<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 1534<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=11%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=44.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
								<a href="http://rugmonster.org" title="" target="_blank"><img src="Themes/babylon/images/www_sm.gif" alt="WWW" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg14661.html#msg14661"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_14661">
										<a href="index.php%3Ftopic=2734.msg14661.html#msg14661">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #7 on:</b> August 28, 2006, 09:35:48 pm &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">I just made an update to blockgen that no longer requires linblock for use on OpenBSD with pf.<br /><br />It assumes you have a table in pf called &quot;sshers&quot;. You can get it <a href="http://rugmonster.org/code/blockgen-pf.pl" target="_blank">HERE</a>.<br /><br />I have a cronjob setup to run it every minute and it updates the file /var/blockgen/sshers and also updates the sshers table. Here&#039;s what my pf.conf looks like:<br /><br /><div class="codeheader">Code:</div><div class="code">#&nbsp; &nbsp; &nbsp; &nbsp;$OpenBSD: pf.conf,v 1.31 2006/01/30 12:20:31 camield Exp $<br />#<br /># See pf.conf(5) and /usr/share/pf for syntax and examples.<br /># Remember to set net.inet.ip.forwarding=1 and/or net.inet6.ip6.forwarding=1<br /># in /etc/sysctl.conf if packets are to be forwarded between interfaces.<br /><br />table &lt;sshers&gt; persist file &quot;/var/blockgen/sshers&quot;<br /><br />block in quick on xl0 proto tcp from &lt;sshers&gt; to any port ssh<br />pass in all<br /></div></div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_14661">
									&#171; <i>Last Edit: August 28, 2006, 09:38:21 pm by rugmonster</i> &#187;
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">--<br />Daniel</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg14664"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=83.html" title="View the profile of Brent">Brent</a></b>
							<div class="smalltext">
								Master<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 464<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=37%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								kaboom?<br />
								<br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=83.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg14664.html#msg14664"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_14664">
										<a href="index.php%3Ftopic=2734.msg14664.html#msg14664">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #8 on:</b> August 28, 2006, 11:35:07 pm &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">A while ago, I moved my ssh port from 22 to another common port.<br /><br />Either my secure log isn&#039;t logging like it used to, or I&#039;ve had exactly *zero* folks sniffing around since I made the move.&nbsp; I don&#039;t see the point in going through all that trouble when you could eliminate 99.999% of the random script kiddie problem with a simple port change.&nbsp; Of course, if you&#039;re a busness, you might still have the problem of a targeted attack, but that&#039;s not much of a threat to your average home user.</div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_14664">
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">&quot;Which is worse, ignorance or apathy ?&nbsp; Who knows?&nbsp; Who cares?&quot;</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 1px 1px 0 1px;">
		<a name="msg14666"></a><a name="new"></a>
		<table width="100%" cellpadding="3" cellspacing="0" border="0">
			<tr><td class="windowbg2">
				<table width="100%" cellpadding="5" cellspacing="0" style="table-layout: fixed;">
					<tr>
						<td valign="top" width="16%" rowspan="2" style="overflow: hidden;">
							<b><a href="index.php%3Faction=profile%3Bu=44.html" title="View the profile of rugmonster">rugmonster</a></b>
							<div class="smalltext">
								Old Hand<br />
								<img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><img src="Themes/babylon/images/star.gif" alt="*" border="0" /><br />
								<br />
								Approval: 0<br />
								Posts: 1534<br />
								<br />
								<div style="overflow: auto; width: 100%;"><img src="index.php%3Faction=dlattach%3Battach=11%3Btype=avatar" alt="" class="avatar" border="0" /></div><br />
								
								
								
								<br />
								<a href="index.php%3Faction=profile%3Bu=44.html"><img src="Themes/babylon/images/icons/profile_sm.gif" alt="View Profile" title="View Profile" border="0" /></a>
								<a href="http://rugmonster.org" title="" target="_blank"><img src="Themes/babylon/images/www_sm.gif" alt="WWW" border="0" /></a>
							</div>
						</td>
						<td valign="top" width="85%" height="100%">
							<table width="100%" border="0"><tr>
								<td valign="middle"><a href="index.php%3Ftopic=2734.msg14666.html#msg14666"><img src="Themes/babylon/images/post/xx.gif" alt="" border="0" /></a></td>
								<td valign="middle">
									<div style="font-weight: bold;" id="subject_14666">
										<a href="index.php%3Ftopic=2734.msg14666.html#msg14666">Re: linblock - like peerguardian...but better</a>
									</div>
									<div class="smalltext">&#171; <b>Reply #9 on:</b> August 29, 2006, 04:59:09 am &#187;</div></td>
								<td align="right" valign="bottom" height="20" nowrap="nowrap" style="font-size: smaller;">
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="post">I&#039;ve heard other people say the same thing, but it will only be a matter of time before the bots get smarter and gain the capabilities included in nmap to do a service version check along with a port scan. Then it won&#039;t matter what port you have services running on.<br /><br />Edit:<br />Oh yeah, another thing I just thought of; to really stop the bots trying brute force logins, turn off password authentication and use certificates and use the AllowUsers to specify the users you wish to be able to log in. I just get tired of my logs filling up with all of the failed attempts. By using my script, I just block them and they aren&#039;t clogging up my logs, which I do check.</div>
						</td>
					</tr>
					<tr>
						<td valign="bottom" class="smalltext" width="85%">
							<table width="100%" border="0" style="table-layout: fixed;"><tr>
								<td colspan="2" class="smalltext" width="100%">
								</td>
							</tr><tr>
								<td valign="bottom" class="smalltext" id="modified_14666">
									&#171; <i>Last Edit: August 29, 2006, 07:48:04 am by rugmonster</i> &#187;
								</td>
								<td align="right" valign="bottom" class="smalltext">
									<img src="Themes/babylon/images/ip.gif" alt="" border="0" />
									Logged
								</td>
							</tr></table>
							<hr width="100%" size="1" class="hrcolor" />
							<div class="signature">--<br />Daniel</div>
						</td>
					</tr>
				</table>
			</td></tr>
		</table>
	</td></tr>
	<tr><td style="padding: 0 0 1px 0;"></td></tr>
</table>
<a name="lastPost"></a>

<table width="100%" cellpadding="3" cellspacing="0" border="0" class="tborder" style="margin-top: 1ex;">
	<tr>
		<td class="catbg" width="100%" height="30">
			<table cellpadding="3" cellspacing="0" width="100%">
				<tr>
					<td>
						<a name="bot"></a><b>Pages:</b> [<b>1</b>] 
					</td>
					<td align="right" style="font-size: smaller;"><a href="index.php%3Faction=printpage%3Btopic=2734.0.html" target="_blank"><img src="Themes/babylon/images/english/print.gif" alt="Print" border="0" /></a>&nbsp;
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
<script language="JavaScript" type="text/javascript" src="Themes/default/xml_topic.js"></script>
<script language="JavaScript" type="text/javascript"><!-- // --><![CDATA[
	quickReplyCollapsed = true;

	smf_topic = 2734;
	smf_start = 0;
	smf_show_modify = 1;

	// On quick modify, this is what the body will look like.
	var smf_template_body_edit = '<div id="error_box" style="padding: 4px; color: red;"></div><textarea class="editor" name="message" rows="12" style="width: 94%; margin-bottom: 10px;">%body%</textarea><br /><input type="hidden" name="sc" value="706836f2c9352cfd8e021c614df871f7" /><input type="hidden" name="topic" value="2734" /><input type="hidden" name="msg" value="%msg_id%" /><div style="text-align: center;"><input type="submit" name="post" value="Save" onclick="return modify_save(\'706836f2c9352cfd8e021c614df871f7\');" accesskey="s" />&nbsp;&nbsp;<input type="submit" name="cancel" value="Cancel" onclick="return modify_cancel();" /></div>';

	// And this is the replacement for the subject.
	var smf_template_subject_edit = '<input type="text" name="subject" value="%subject%" size="60" style="width: 99%;"  maxlength="80" />';

	// Restore the message to this after editing.
	var smf_template_body_normal = '%body%';
	var smf_template_subject_normal = '<a href="http://www.pcolalug.org/smf/index.php?topic=2734.msg%msg_id%#msg%msg_id%">%subject%</a>';
	var smf_template_top_subject = "Topic: %subject% &nbsp;(Read 6984 times)"

	if (window.XMLHttpRequest)
		showModifyButtons();
// ]]></script>
<table border="0" width="100%" cellpadding="0" cellspacing="0">
	<tr>
		<td valign="top" align="right" class="smalltext"> <span class="nav"> <a href="index.php%3Ftopic=2734.0%3Bprev_next=prev.html#new">&laquo; previous</a> <a href="index.php%3Ftopic=2734.0%3Bprev_next=next.html#new">next &raquo;</a></span></td>
	</tr>
</table>
<div style="padding-top: 4px; padding-bottom: 4px;"></div>
</form>
<div align="right" style="margin-bottom: 1ex;">
	<form action="index.php.html" method="get" accept-charset="ISO-8859-1">
		<span class="smalltext">Jump to:</span>
		<select name="jumpto" id="jumpto" onchange="if (this.selectedIndex > 0 &amp;&amp; this.options[this.selectedIndex].value) window.location.href = smf_scripturl + this.options[this.selectedIndex].value.substr(smf_scripturl.indexOf('?') == -1 || this.options[this.selectedIndex].value.substr(0, 1) != '?' ? 0 : 1);">
			<option value="">Please select a destination:</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="#2">Club Stuff</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="?board=3.0"> => Announcements</option>
			<option value="?board=40.0"> => PcolaLUG By-Laws</option>
			<option value="?board=4.0"> => Club discussions</option>
			<option value="?board=26.0"> => Articles</option>
			<option value="?board=27.0"> => Swap Meet</option>
			<option value="?board=29.0"> => Introductions</option>
			<option value="?board=30.0"> => Library</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="#3">Distributions</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="?board=44.0"> => RPM Based Distributions</option>
			<option value="?board=45.0"> => Debian Based Distrtibutions</option>
			<option value="?board=46.0"> => Other Linux Distributions</option>
			<option value="?board=47.0"> => Other Operating Systems</option>
			<option value="?board=41.0"> => Security</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="#4">Hardware</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="?board=12.0"> => Graphics/Video</option>
			<option value="?board=14.0"> => Network</option>
			<option value="?board=16.0"> => Other Hardware</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="#5">Software</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="?board=17.0"> => Games</option>
			<option value="?board=19.0"> => Desktops</option>
			<option value="?board=48.0" selected="selected"> => Networking</option>
			<option value="?board=22.0"> => Other Software</option>
			<option value="?board=32.0"> => Programming/Development</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="#6">Misc</option>
			<option value="" disabled="disabled">-----------------------------</option>
			<option value="?board=38.0"> => Newbie Corner</option>
			<option value="?board=24.0"> => Computer General</option>
			<option value="?board=25.0"> => Other Misc</option>
			<option value="?board=31.0"> => IT Jobs</option>
			<option value="?board=36.0"> => The Big Debate</option>
		</select>&nbsp;
		<input type="button" value="go" onclick="if (this.form.jumpto.options[this.form.jumpto.selectedIndex].value) window.location.href = 'http://www.pcolalug.org/smf/index.php' + this.form.jumpto.options[this.form.jumpto.selectedIndex].value;" />
	</form>
</div>
<br /></td>
	</tr></table>

	<div id="footerarea" style="text-align: center; padding-bottom: 1ex;">
		<script language="JavaScript" type="text/javascript"><!-- // --><![CDATA[
			function smfFooterHighlight(element, value)
			{
				element.src = smf_images_url + "/" + (value ? "h_" : "") + element.id + ".gif";
			}
		// ]]></script>
		<table cellspacing="0" cellpadding="3" border="0" width="100%">
			<tr>
				<td width="28%" valign="middle" align="right">
					<a href="http://www.mysql.com/" target="_blank"><img id="powered-mysql" src="Themes/babylon/images/powered-mysql.gif" alt="Powered by MySQL" width="54" height="20" style="margin: 5px 16px;" border="0" onmouseover="smfFooterHighlight(this, true);" onmouseout="smfFooterHighlight(this, false);" /></a>
					<a href="http://www.php.net/" target="_blank"><img id="powered-php" src="Themes/babylon/images/powered-php.gif" alt="Powered by PHP" width="54" height="20" style="margin: 5px 16px;" border="0" onmouseover="smfFooterHighlight(this, true);" onmouseout="smfFooterHighlight(this, false);" /></a>
				</td>
				<td valign="middle" align="center" style="white-space: nowrap;">
					
		<span class="smalltext" style="display: inline; visibility: visible; font-family: Verdana, Arial, sans-serif;"><a href="http://www.simplemachines.org/" title="Simple Machines Forum" target="_blank">Powered by SMF 1.1.13</a> |
<a href="http://www.simplemachines.org/about/copyright.php" title="Free Forum Software" target="_blank">SMF &copy; 2006-2011, Simple Machines LLC</a>
		</span>
				</td>
				<td width="28%" valign="middle" align="left">
					<a href="http://validator.w3.org/check/referer" target="_blank"><img id="valid-xhtml10" src="Themes/babylon/images/valid-xhtml10.gif" alt="Valid XHTML 1.0!" width="54" height="20" style="margin: 5px 16px;" border="0" onmouseover="smfFooterHighlight(this, true);" onmouseout="smfFooterHighlight(this, false);" /></a>
					<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank"><img id="valid-css" src="Themes/babylon/images/valid-css.gif" alt="Valid CSS!" width="54" height="20" style="margin: 5px 16px;" border="0" onmouseover="smfFooterHighlight(this, true);" onmouseout="smfFooterHighlight(this, false);" /></a>
				</td>
			</tr>
		</table>
		<span class="smalltext">Page created in 0.39 seconds with 16 queries.</span>
		</div>
		<div id="ajax_in_progress" style="display: none;">Loading...</div>
	</body>
</html>